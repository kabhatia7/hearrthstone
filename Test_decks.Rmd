---
title: "Test"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(rvest)
library(httr)
library(jsonlite)
library(hearrthstone)
library(RSelenium)
library(stringr)
```

Retrieve current meta data from Hsreplay.net to use as training data for the model
```{r}
rd <- rsDriver(browser="firefox", port= 1093L, verbose=F)
remDr <- rd[["client"]]
pages <- c()
for(i in 1:3){
remDr$navigate(paste0("https://hsreplay.net/decks/#minGames=1000&page=",i))
Sys.sleep(1)
pages[i] <- remDr$getPageSource()[[1]]
}
links <- read_html(paste(pages, collapse = '')) %>% 
  html_nodes('a.deck-tile') %>% 
  html_attr('href')
meta <- map_dfr(stringr::str_remove(links,"/decks/"), ~get_hsreplay_decks(.x))

remDr$close()
```


```{r}
df_decks_dummy <- 
  map_dfr(1:nrow(meta),~get_dummys(meta$deckcode[.x],meta$name[.x])) %>% 
  replace(is.na(.),0) 
  
```

